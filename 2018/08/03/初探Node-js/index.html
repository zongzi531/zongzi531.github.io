

<!DOCTYPE html>
<html lang="zh-CN" xmlns:v-bind="http://www.w3.org/1999/xhtml">

<head>
    <title>初探Node.js - Zong</title>
<meta charset="utf-8">
<meta name="X-UA-Compatible" content="IE=edge">
<meta name="author" content="Zong">
<meta name="description" content="



7月计划学习Node.js，试着为react-to-do-list项目实现一个简单的后端服务。 =&amp;gt;...">
<meta name="keywords" content="Blog JavaScript TypeScript Front-end CSS">

    <meta charset="utf-8">
    <meta name="X-UA-Compatible" content="IE=edge">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
    <meta content="telephone=no" name="format-detection">
    <meta name="renderer" content="webkit">
    <meta name="theme-color" content="#ffffff">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/css/bootstrap.min.css" integrity="sha256-eSi1q2PG6J7g7ib17yAaWMcrr5GrtohYChqibrV7PBE=" crossorigin="anonymous">
<link rel="stylesheet" href="/css/journal.css?81458716">

<link rel="icon" href="/images/favicon.ico">

<script src="/js/loadCSS.js"></script>
<script>
    loadCSS("https://fonts.googleapis.com/css?family=Lora|Montserrat|Fira+Mono|Material+Icons");
    (function (d) {
        var config = {
                kitId: 'dwg1tuc',
                scriptTimeout: 3000,
                async: true
            },
            h = d.documentElement, t = setTimeout(function () {
                h.className = h.className.replace(/\bwf-loading\b/g, "") + " wf-inactive";
            }, config.scriptTimeout), tk = d.createElement("script"), f = false,
            s = d.getElementsByTagName("script")[0], a;
        h.className += " wf-loading";
        tk.src = 'https://use.typekit.net/' + config.kitId + '.js';
        tk.async = true;
        tk.onload = tk.onreadystatechange = function () {
            a = this.readyState;
            if (f || a && a != "complete" && a != "loaded") return;
            f = true;
            clearTimeout(t);
            try {
                Typekit.load(config)
            } catch (e) {
            }
        };
        s.parentNode.insertBefore(tk, s)
    })(document);
</script>
<noscript>
    <link rel="stylesheet"
          href="https://fonts.googleapis.com/css?family=Lora|Montserrat|Anonymous+Pro:400|Material+Icons"/>
</noscript>
<link rel="stylesheet" href="/css/prism-material-oceanic.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head>
<body>
<div id="top"></div>
<div id="app">
<div class="single-column-drawer-container" ref="drawer"
     v-bind:class="{ 'single-column-drawer-container-active': isDrawerOpen }">
    <div class="drawer-content">
        <div class="drawer-menu">
            <a class="a-block drawer-menu-item false" href="https://zongzi531.com">
                首页
            </a>
            

            
            
                
                    <a class="a-block drawer-menu-item false" href="/bangumi/index.html">
                        番組
                    </a>
                
            
                
                    <a class="a-block drawer-menu-item false" href="/commuting/index.html">
                        通勤那点事
                    </a>
                
            
                
            
                
                    <a class="a-block drawer-menu-item false" href="/nihongonokona/index.html">
                        日本語のコーナー
                    </a>
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
                    <a class="a-block drawer-menu-item false" href="/syoukai/index.html">
                        紹介
                    </a>
                
            
                
            
                
            
                
            
                
            
                
            

            
        </div>
    </div>
</div>
<transition name="fade">
    <div v-bind:class="{ 'single-column-drawer-mask': mounted }" v-if="isDrawerOpen" v-on:click="toggleDrawer"></div>
</transition>
<nav ref="navBar" class="navbar sticky-top navbar-light single-column-nav-container">
    <div ref="navBackground" class="nav-background"></div>
    <div class="container container-narrow nav-content">
        <button id="nav_dropdown_btn" class="nav-dropdown-toggle" type="button" v-on:click="toggleDrawer">
            <i class="material-icons">
                menu
            </i>
        </button>
        <a ref="navTitle" class="navbar-brand" href="/">
            Zong
        </a>
    </div>
</nav>
<div class="single-column-header-container" ref="pageHead"
     v-bind:style="{ transform: 'translateZ(0px) translateY('+.3*scrollY+'px)', opacity: 1-navOpacity }">
    <a href="/">
        <div class="single-column-header-title">Zong</div>
        <div class="single-column-header-subtitle"></div>
    </a>
</div>
<div ref="sideContainer" class="side-container">
    <a class="a-block nav-head false" href="/">
        <div class="nav-title">
            Zong
        </div>
        <div class="nav-subtitle">
            人之所以能<br>，是相信能
        </div>
    </a>

    <div class="nav-link-list">
        

        
        
            
                <a class="a-block nav-link-item false" href="/bangumi/index.html">
                    番組
                </a>
            
        
            
                <a class="a-block nav-link-item false" href="/commuting/index.html">
                    通勤那点事
                </a>
            
        
            
        
            
                <a class="a-block nav-link-item false" href="/nihongonokona/index.html">
                    日本語のコーナー
                </a>
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
                <a class="a-block nav-link-item false" href="/syoukai/index.html">
                    紹介
                </a>
            
        
            
        
            
        
            
        
            
        
            
        

        
    </div>

    <div class="nav-footer">
        <div style="margin-bottom: 8px;">
            <a title="GitHub" href="https://github.com/zongzi531" target="_blank" rel="noopener" style="margin: 0px 2px;"><svg height="16" width="16" viewBox="0 0 16 16" version="1.1" aria-hidden="true"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path></svg></a>
            <a title="知乎" href="https://www.zhihu.com/people/zongzi531/posts" target="_blank" rel="noopener" style="margin: 0px 2px;"><img height="16" src="https://static.zhihu.com/static/favicon.ico"></a>
            <a title="掘金" href="https://juejin.im/user/58747cf2ac502e00646e3b8b/posts" target="_blank" rel="noopener" style="margin: 0px 2px;"><img height="16" src="https://b-gold-cdn.xitu.io/favicons/v2/favicon.ico"></a>
            <a title="力扣" href="https://leetcode-cn.com/u/zongzi0531/" target="_blank" rel="noopener" style="margin: 0px 2px;"><img height="16" src="https://static.leetcode-cn.com/cn-assets/icons/favicon-32x32.png"></a>
        </div>
        &copy; 2017 - 2021 <a href="https://zongzi531.com">Zong</a>
    </div>
</div>
<div ref="extraContainer" class="extra-container">
    <div class="pagination">
        <a id="globalBackToTop" class="pagination-action animated-visibility" href="#top" :class="{ invisible: scrollY == 0 }">
            <i class="material-icons pagination-action-icon">
                keyboard_arrow_up
            </i>
        </a>

        
    </div>
</div>



<div ref="streamContainer" class="stream-container">
    <div class="post-list-container post-list-container-shadow">
        <div class="post">
            <div class="post-head-wrapper"
                 style="background-image: url('/2018/08/03/初探Node-js/pic0.jpeg')">
                <div class="post-title">
                    初探Node.js
                    <div class="post-meta">
                        <time datetime="2018-08-03T19:11:32.000Z" itemprop="datePublished">
                            2018-08-03 19:11
                        </time>&nbsp;
                        
                        
                        <i class="material-icons" style="">folder</i>
                        
                        <a href='/categories/JavaScript/'>JavaScript</a>
                        
                        
    
                        
                        
                        <i class="material-icons" style="">label</i>
                        
                        <a href='/tags/JavaScript/'>JavaScript</a>, 
                        
                        <a href='/tags/React/'>React</a>, 
                        
                        <a href='/tags/TypeScript/'>TypeScript</a>, 
                        
                        <a href='/tags/Node-js/'>Node.js</a>
                        
                        
                    </div>
                </div>
            </div>
    
            <div class="post-body-wrapper">
                <div class="post-body">
                    <!-- no node -->

<a id="more"></a>

<p>7月计划学习Node.js，试着为react-to-do-list项目实现一个简单的后端服务。 =&gt; 完成</p>
<p>同时，公司项目经验分享：</p>
<h2 id="巧用Autoprefixer自动管理CSS属性前缀"><a href="#巧用Autoprefixer自动管理CSS属性前缀" class="headerlink" title="巧用Autoprefixer自动管理CSS属性前缀"></a>巧用Autoprefixer自动管理CSS属性前缀</h2><p><img src="pic1.png" alt="Autoprefixer logo"></p>
<p>公司移动端项目需要做兼容，首先JavaScript相关的兼容可以考虑使用<code>babel-polyfill</code>来解决。那么CSS自然就考虑到使用PostCSS Autoprefixer。</p>
<p>举个例子：查看<a href="https://caniuse.com/#search=transform" target="_blank" rel="noopener"><code>CSS3 transform</code></a>属性会发现Android 4.2下可以使用<code>-webkit-</code>来实现<code>transform</code>，然后我将<code>Android &gt;= 4.2</code>加入至<code>browserslist</code>来使得Autoprefixer完成它的工作。</p>
<h3 id="如何配置browserslist？"><a href="#如何配置browserslist？" class="headerlink" title="如何配置browserslist？"></a>如何配置browserslist？</h3><p><img src="pic2.png" alt="browserslist logo"></p>
<p>以下内容来自官网README</p>
<h4 id="Full-List"><a href="#Full-List" class="headerlink" title="Full List"></a>Full List</h4><p>You can specify the browser and Node.js versions by queries (case insensitive):</p>
<ul>
<li><code>&gt; 5%</code>: browsers versions selected by global usage statistics.<br><code>&gt;=</code>, <code>&lt;</code> and <code>&lt;=</code> work too.</li>
<li><code>&gt; 5% in US</code>: uses USA usage statistics. It accepts [two-letter country code].</li>
<li><code>&gt; 5% in alt-AS</code>: uses Asia region usage statistics. List of all region codes<br>can be found at [<code>caniuse-lite/data/regions</code>].</li>
<li><code>&gt; 5% in my stats</code>: uses [custom usage data].</li>
<li><code>cover 99.5%</code>: most popular browsers that provide coverage.</li>
<li><code>cover 99.5% in US</code>: same as above, with [two-letter country code].</li>
<li><code>cover 99.5% in my stats</code>: uses [custom usage data].</li>
<li><code>maintained node versions</code>: all Node.js versions, which are [still maintained]<br>by Node.js Foundation.</li>
<li><code>node 10</code> and <code>node 10.4</code>: selects latest Node.js <code>10.x.x</code><br>or <code>10.4.x</code> release.</li>
<li><code>extends browserslist-config-mycompany</code>: take queries from<br><code>browserslist-config-mycompany</code> npm package.</li>
<li><code>ie 6-8</code>: selects an inclusive range of versions.</li>
<li><code>Firefox &gt; 20</code>: versions of Firefox newer than 20.<br><code>&gt;=</code>, <code>&lt;</code> and <code>&lt;=</code> work too.</li>
<li><code>iOS 7</code>: the iOS browser version 7 directly.</li>
<li><code>Firefox ESR</code>: the latest [Firefox ESR] version.</li>
<li><code>unreleased versions</code> or <code>unreleased Chrome versions</code>:<br>alpha and beta versions.</li>
<li><code>last 2 major versions</code> or <code>last 2 iOS major versions</code>:<br>all minor/patch releases of last 2 major versions.</li>
<li><code>since 2015</code> or <code>last 2 years</code>: all versions released since year 2015<br>(also <code>since 2015-03</code> and <code>since 2015-03-10</code>).</li>
<li><code>dead</code>: browsers from <code>last 2 version</code> query, but with less than 0.5%<br>in global usage statistics and without official support or updates<br>for 24 months. Right now it is <code>IE 10</code>, <code>IE_Mob 10</code>, <code>BlackBerry 10</code>,<br><code>BlackBerry 7</code>, and <code>OperaMobile 12.1</code>.</li>
<li><code>last 2 versions</code>: the last 2 versions for <em>each</em> browser.</li>
<li><code>last 2 Chrome versions</code>: the last 2 versions of Chrome browser.</li>
<li><code>defaults</code>: Browserslist’s default browsers<br>(<code>&gt; 0.5%, last 2 versions, Firefox ESR, not dead</code>).</li>
<li><code>not ie &lt;= 8</code>: exclude browsers selected by previous queries.</li>
</ul>
<p>You can add <code>not</code> to any query.</p>
<h4 id="Browsers"><a href="#Browsers" class="headerlink" title="Browsers"></a>Browsers</h4><p>Names are case insensitive:</p>
<ul>
<li><code>Android</code> for Android WebView.</li>
<li><code>Baidu</code> for Baidu Browser.</li>
<li><code>BlackBerry</code> or <code>bb</code> for Blackberry browser.</li>
<li><code>Chrome</code> for Google Chrome.</li>
<li><code>ChromeAndroid</code> or <code>and_chr</code> for Chrome for Android</li>
<li><code>Edge</code> for Microsoft Edge.</li>
<li><code>Electron</code> for Electron framework. It will be converted to Chrome version.</li>
<li><code>Explorer</code> or <code>ie</code> for Internet Explorer.</li>
<li><code>ExplorerMobile</code> or <code>ie_mob</code> for Internet Explorer Mobile.</li>
<li><code>Firefox</code> or <code>ff</code> for Mozilla Firefox.</li>
<li><code>FirefoxAndroid</code> or <code>and_ff</code> for Firefox for Android.</li>
<li><code>iOS</code> or <code>ios_saf</code> for iOS Safari.</li>
<li><code>Node</code> for Node.js.</li>
<li><code>Opera</code> for Opera.</li>
<li><code>OperaMini</code> or <code>op_mini</code> for Opera Mini.</li>
<li><code>OperaMobile</code> or <code>op_mob</code> for Opera Mobile.</li>
<li><code>QQAndroid</code> or <code>and_qq</code> for QQ Browser for Android.</li>
<li><code>Safari</code> for desktop Safari.</li>
<li><code>Samsung</code> for Samsung Internet.</li>
<li><code>UCAndroid</code> or <code>and_uc</code> for UC Browser for Android.</li>
</ul>
<h2 id="遭遇前后端不分离项目的兼容性问题"><a href="#遭遇前后端不分离项目的兼容性问题" class="headerlink" title="遭遇前后端不分离项目的兼容性问题"></a>遭遇前后端不分离项目的兼容性问题</h2><p>当<code>&lt;canvas&gt;</code>标签遇上IE，CSS样式问题也就出来了。还好社区有个库是用来专门解决这个问题，当当当当！html5shiv了解一下。</p>
<p><img src="pic3.png" alt="Babel logo"></p>
<p>因为项目已经完成，只做兼容性调整，那么临时选择的解决方案就是手动进行语法降级，手动语法降级好痛苦 :( ，相当于人工<code>babel-polyfill</code>（事后灵机一动，可以直接去Babel官网转换），所以后续我打算使用Webpack来支持前后端不分离项目，使用node工程化来提升开发体验。</p>
<p>为了统一公司前后端不分离项目的CSS样式，同时解决兼容性方面的问题，此时Webpack就登场了。之前刚好在上一家公司写过一个Webpack多页面工具（基于Jade模板引擎 + jQuery技术栈），此次项目的特点前后端不分离，所以采用（HTML + 后端模板引擎Thymeleaf + Vue技术栈）来实现这个Webpack多页面工具。</p>
<p>前后端不分离情况下，项目开发需要执行<code>mvn tomcat7:run</code>命令来启动（以下简称tomcat模式）。</p>
<p><img src="pic4.png" alt="Thymeleaf logo"></p>
<p>简单介绍一下Thymeleaf模板引擎，展示一段示例代码：</p>
<pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name"><span class="token namespace">th:</span>inline</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>javascript<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript">
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>window<span class="token punctuation">.</span>__th__<span class="token punctuation">)</span> <span class="token punctuation">{</span> window<span class="token punctuation">.</span>__th__ <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
  window<span class="token punctuation">.</span>__th__<span class="token punctuation">.</span>something <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>$<span class="token punctuation">{</span>something<span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>以类似这样的方式来获取数据，并结合Vue开发，具体语法请参照官网文档<a href="https://www.thymeleaf.org/doc/tutorials/3.0/usingthymeleaf.html#javascript-inlining" target="_blank" rel="noopener">Thymeleaf 12.3 JavaScript inlining</a></p>
<h3 id="jQuery-html-API-与-原生-innerHTML-API"><a href="#jQuery-html-API-与-原生-innerHTML-API" class="headerlink" title="jQuery html API 与 原生 innerHTML API"></a>jQuery html API 与 原生 innerHTML API</h3><p>考虑PAJAX方式替换页面内容，发现原生 innerHTML API替换DOM内容后，不会自动执行<code>&lt;srcipt&gt;</code>标签，但是jQuery html API实现了这一点。</p>
<p>查阅其核心源码<a href="https://github.com/jquery/jquery/blob/master/src/manipulation.js" target="_blank" rel="noopener">manipulation.js</a>如下：</p>
<pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">domManip</span><span class="token punctuation">(</span> collection<span class="token punctuation">,</span> args<span class="token punctuation">,</span> callback<span class="token punctuation">,</span> ignored <span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>
  <span class="token comment" spellcheck="true">// Require either new content or an interest in ignored elements to invoke the callback</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> first <span class="token operator">||</span> ignored <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    scripts <span class="token operator">=</span> jQuery<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span> <span class="token function">getAll</span><span class="token punctuation">(</span> fragment<span class="token punctuation">,</span> <span class="token string">"script"</span> <span class="token punctuation">)</span><span class="token punctuation">,</span> disableScript <span class="token punctuation">)</span><span class="token punctuation">;</span>
    hasScripts <span class="token operator">=</span> scripts<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">// 获取&lt;srcipt>标签数量</span>

    <span class="token operator">...</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span> hasScripts <span class="token punctuation">)</span> <span class="token punctuation">{</span>
      doc <span class="token operator">=</span> scripts<span class="token punctuation">[</span> scripts<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span> <span class="token punctuation">]</span><span class="token punctuation">.</span>ownerDocument<span class="token punctuation">;</span>

      <span class="token comment" spellcheck="true">// Reenable scripts</span>
      jQuery<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span> scripts<span class="token punctuation">,</span> restoreScript <span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment" spellcheck="true">// Evaluate executable scripts on first document insertion</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> hasScripts<span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        node <span class="token operator">=</span> scripts<span class="token punctuation">[</span> i <span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span> rscriptType<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span> node<span class="token punctuation">.</span>type <span class="token operator">||</span> <span class="token string">""</span> <span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>
          <span class="token operator">!</span>dataPriv<span class="token punctuation">.</span><span class="token function">access</span><span class="token punctuation">(</span> node<span class="token punctuation">,</span> <span class="token string">"globalEval"</span> <span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>
          jQuery<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span> doc<span class="token punctuation">,</span> node <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>

          <span class="token keyword">if</span> <span class="token punctuation">(</span> node<span class="token punctuation">.</span>src <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span> node<span class="token punctuation">.</span>type <span class="token operator">||</span> <span class="token string">""</span> <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token operator">!==</span> <span class="token string">"module"</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>

            <span class="token comment" spellcheck="true">// Optional AJAX dependency, but won't run scripts if not present</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span> jQuery<span class="token punctuation">.</span>_evalUrl <span class="token punctuation">)</span> <span class="token punctuation">{</span>
              jQuery<span class="token punctuation">.</span><span class="token function">_evalUrl</span><span class="token punctuation">(</span> node<span class="token punctuation">.</span>src <span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token function">DOMEval</span><span class="token punctuation">(</span> node<span class="token punctuation">.</span>textContent<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span> rcleanScript<span class="token punctuation">,</span> <span class="token string">""</span> <span class="token punctuation">)</span><span class="token punctuation">,</span> doc<span class="token punctuation">,</span> node <span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> collection<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>有关于<code>domManip</code>方法的浅析文章网上也有不少，可以搜索看看。</p>
<p>可见jQuery是真的给力，确实需要找个时间读一读jQuery的源码，或者找个时间把这个方法剥离出来也是一个不错的选择。</p>
<h3 id="开发模式改造"><a href="#开发模式改造" class="headerlink" title="开发模式改造"></a>开发模式改造</h3><p><img src="pic5.png" alt="Webpack logo"></p>
<p>起初我选择的是模块化开发模式，因为项目的文件采用PAJAX方式加载，可以理解为子页面单独加载的模式。</p>
<p>所以，我会使用Webpack的<code>CommonsChunkPlugin</code>来提取共同模块，但是因为Chunk文件只会加载一次，若子页面重复加载，js文件会跳过执行，并不会渲染页面，我并不想发生这样的情况，查看Webpack源码<a href="https://github.com/webpack/webpack/blob/master/lib/MainTemplate.js" target="_blank" rel="noopener">webpack/lib/MainTemplate.js</a>你会发现，若该模块已被加载，Webpack则不会再次加载该模块。</p>
<pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token operator">...</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>require<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">"MainTemplate"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>source<span class="token punctuation">,</span> chunk<span class="token punctuation">,</span> hash<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> Template<span class="token punctuation">.</span><span class="token function">asString</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
    source<span class="token punctuation">,</span>
    <span class="token string">"// Check if module is in cache"</span><span class="token punctuation">,</span>
    <span class="token string">"if(installedModules[moduleId]) {"</span><span class="token punctuation">,</span>
    Template<span class="token punctuation">.</span><span class="token function">indent</span><span class="token punctuation">(</span><span class="token string">"return installedModules[moduleId].exports;"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string">"}"</span><span class="token punctuation">,</span>
    <span class="token operator">...</span>
  <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">...</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>很糟糕，我试着修改源码，移除这段代码，但是其他的问题接踵而至，因为我每个子页面都有<code>import</code>部分相同的模块，同样的模块加载多次会导致页面报错。</p>
<p>此时，我想到使用IIFE解决此问题，我将公共的模块绑定至<code>window</code>全局对象，采用polyfill的形式加载。公共库则采用CDN加载，抛弃使用模块化开发模式。并且移除<code>CommonsChunkPlugin</code>，使得每个子页面有独立的Webpack module cache，成功的解决了此问题。</p>
<p>查阅相关Issues，我似乎看到Webpack 4.x有类似解决办法，但是我使用的是Webpack 3.8.1，所以暂时不考虑破坏性升级版本，在此版本上解决这个问题。此问题告一段落。</p>
<p>关于<code>webpack-dev-server</code>的调试开发，我暂时没有解决，因为<code>devServer</code>生成的文件是在内存中的，并没有真实文件，以至于无法通过tomcat模式访问到，我暂时想到的是试着去用反向代理解决这个问题，但是还没有去实践。我准备试着去尝试解决，这样这套工具在我司前后端项目中能为前端工程化提升开发体验做出贡献，既能做到调试开发，也能做到自动完成兼容性等代码优化。</p>
<h3 id="题外话"><a href="#题外话" class="headerlink" title="题外话"></a>题外话</h3><p>项目优化过程中涉及到图片压缩问题，前端也同样会压缩用户上传的图片，来减少带宽压力。在编写过程中，我对比了下iView和Element Upload组件的源码，发现Element果然是我心中的榜样，写的确实给力，让开发者少了很多烦恼，当然也正是iView，让我学习到了一些新的知识。</p>
<p>刚好我压缩完的图片是<code>Blob</code>类型，导致我在使用iView组件时，无法上传压缩后的图片，而是被强制上传原图。</p>
<pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// iView Upload Component 相关源码</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>before <span class="token operator">&amp;&amp;</span> before<span class="token punctuation">.</span>then<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  before<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>processedFile <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// 压缩图片为Blob类型，导致我的图片白压缩了……，只能上传原图</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>Object<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>toString<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>processedFile<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'[object File]'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span>processedFile<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token operator">...</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// Element Upload Component 相关源码</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>before <span class="token operator">&amp;&amp;</span> before<span class="token punctuation">.</span>then<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  before<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>processedFile <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> fileType <span class="token operator">=</span> Object<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>toString<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>processedFile<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">// 这一步就处理的很NICE</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>fileType <span class="token operator">===</span> <span class="token string">'[object File]'</span> <span class="token operator">||</span> fileType <span class="token operator">===</span> <span class="token string">'[object Blob]'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment" spellcheck="true">// 学习了学习了</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>fileType <span class="token operator">===</span> <span class="token string">'[object Blob]'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        processedFile <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token punctuation">[</span>processedFile<span class="token punctuation">]</span><span class="token punctuation">,</span> rawFile<span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token punctuation">{</span>
          type<span class="token punctuation">:</span> rawFile<span class="token punctuation">.</span>type
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token operator">...</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span>processedFile<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span>rawFile<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token operator">...</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>但是在IE下视乎<code>Blob</code>类型存在问题，我暂时还没有解决，当然我选择折中方案，如果遇到不兼容情况，则<code>reject</code>返回原图。</p>
<h2 id="初探Node-js开发"><a href="#初探Node-js开发" class="headerlink" title="初探Node.js开发"></a>初探Node.js开发</h2><p>谈一些项目中的特点吧：</p>
<ul>
<li>对响应信息中的<code>code</code>和<code>message</code>信息进行统一维护。</li>
<li>对请求参数中的静态参数进行统一维护。</li>
<li>感受到了社区所说的回调地狱，采用<code>Async Function</code> + <code>Promise</code>解决。</li>
<li>拒绝无限<code>if</code>，使用<code>express-validator</code>优雅解决参数校验</li>
</ul>
<pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// if 判断实现参数校验</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>token<span class="token punctuation">)</span> <span class="token punctuation">{</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token function">response</span><span class="token punctuation">(</span><span class="token string">'NO_TOKEN'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
<span class="token operator">...</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// 优雅的参数校验</span>
<span class="token keyword">const</span> validatior <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token function">check</span><span class="token punctuation">(</span><span class="token string">'token'</span><span class="token punctuation">,</span> <span class="token string">'NO_TOKEN'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token punctuation">{</span> checkFalsy<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token operator">...</span>
<span class="token punctuation">]</span>

<span class="token keyword">const</span> callback <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>errors<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">validationResult</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>errors<span class="token punctuation">)</span> <span class="token punctuation">{</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token function">response</span><span class="token punctuation">(</span>errors<span class="token punctuation">.</span>msg<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="react-to-do-list改造"><a href="#react-to-do-list改造" class="headerlink" title="react-to-do-list改造"></a>react-to-do-list改造</h2><ul>
<li>因拖拽功能涉及到数据库内容设计问题，暂时移除<code>react-dnd</code>功能。</li>
<li>全面替换为ant-design组件，并且修复Badge组件Type类型错误BUG。</li>
<li>使用箭头函数代替Class方法，移除<code>bind</code>相关代码</li>
<li>使用fetch实现ajax请求工作</li>
<li>使用<code>react-router</code>控制页面跳转</li>
<li>使用<code>git tag</code>为项目打标签（命令参阅文章底部链接）</li>
</ul>
<pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// fetch 相关代码</span>
<span class="token keyword">interface</span> <span class="token class-name">IResponseError</span> <span class="token keyword">extends</span> <span class="token class-name">Error</span> <span class="token punctuation">{</span>
  response<span class="token operator">?</span><span class="token punctuation">:</span> Response
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">IResponse</span> <span class="token punctuation">{</span>
  code<span class="token punctuation">:</span> <span class="token keyword">number</span>
  message<span class="token punctuation">:</span> <span class="token keyword">string</span>
  <span class="token punctuation">[</span>propName<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token keyword">any</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> checkStatus <span class="token operator">=</span> <span class="token punctuation">(</span>response<span class="token punctuation">:</span> Response<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>response<span class="token punctuation">.</span>status <span class="token operator">>=</span> <span class="token number">200</span> <span class="token operator">&amp;&amp;</span> response<span class="token punctuation">.</span>status <span class="token operator">&lt;</span> <span class="token number">300</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> response
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// 为Error扩充了一个response属性</span>
    <span class="token keyword">const</span> error<span class="token punctuation">:</span> IResponseError <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>statusText<span class="token punctuation">)</span>
    error<span class="token punctuation">.</span>response <span class="token operator">=</span> response
    <span class="token keyword">throw</span> error
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> responseProxy <span class="token operator">=</span> <span class="token punctuation">(</span>response<span class="token punctuation">:</span> IResponse<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">// response可能包含其他属性</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> code<span class="token punctuation">,</span> message <span class="token punctuation">}</span> <span class="token operator">=</span> response
  <span class="token keyword">if</span> <span class="token punctuation">(</span>code <span class="token operator">!==</span> SUCCESS<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    antdMessage<span class="token punctuation">.</span><span class="token function">warning</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span>
    <span class="token keyword">throw</span> response
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> response
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// 使用react-router控制页面跳转</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> RouterProps <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react-router'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> FormComponentProps <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'antd/lib/form'</span>
<span class="token operator">...</span>

<span class="token keyword">class</span> <span class="token class-name">Register</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span><span class="token operator">&lt;</span>FormComponentProps <span class="token operator">&amp;</span> RouterProps<span class="token punctuation">,</span> IRegisterState<span class="token operator">></span> <span class="token punctuation">{</span>
  <span class="token keyword">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">:</span> FormComponentProps <span class="token operator">&amp;</span> RouterProps<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> goSignin <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>history<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'/signin'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="Pull-requests"><a href="#Pull-requests" class="headerlink" title="Pull requests"></a>Pull requests</h2><p><img src="pic6.png" alt="releases 3.7.2"></p>
<p><a href="https://github.com/ant-design/ant-design/releases/tag/3.7.2" target="_blank" rel="noopener">releases 3.7.2</a></p>
<ul>
<li><a href="https://github.com/ant-design/ant-design/pull/11421" target="_blank" rel="noopener">ant-design #11421 fix: badge type error.</a></li>
<li><a href="https://github.com/naihe138/vue-imageview/pull/3" target="_blank" rel="noopener">vue-imageview #3 fix: event propagate</a></li>
</ul>
<h2 id="相关仓库"><a href="#相关仓库" class="headerlink" title="相关仓库"></a>相关仓库</h2><ul>
<li><a href="https://github.com/zongzi531/express-mongo-to-do-list-server" target="_blank" rel="noopener">express-mongo-to-do-list-server</a></li>
<li><a href="https://github.com/zongzi531/react-to-do-list" target="_blank" rel="noopener">react-to-do-list</a></li>
</ul>
<h2 id="相关链接"><a href="#相关链接" class="headerlink" title="相关链接"></a>相关链接</h2><ul>
<li><a href="https://caniuse.com/" target="_blank" rel="noopener">Can I use</a></li>
<li><a href="https://github.com/postcss/autoprefixer" target="_blank" rel="noopener">postcss/autoprefixer</a></li>
<li><a href="https://github.com/browserslist/browserslist" target="_blank" rel="noopener">browserslist/browserslist</a></li>
<li><a href="https://github.com/babel/babel/tree/master/packages/babel-polyfill" target="_blank" rel="noopener">babel/babel-polyfill</a></li>
<li><a href="https://github.com/aFarkas/html5shiv" target="_blank" rel="noopener">aFarkas/html5shiv</a></li>
<li><a href="https://www.thymeleaf.org/" target="_blank" rel="noopener">Thymeleaf</a></li>
<li><a href="https://git-scm.com/docs/git-tag" target="_blank" rel="noopener">git-tag</a></li>
<li><a href="https://github.com/iview/iview/blob/2.0/src/components/upload/upload.vue" target="_blank" rel="noopener">iView Upload Component</a></li>
<li><a href="https://github.com/ElemeFE/element/blob/dev/packages/upload/src/upload.vue" target="_blank" rel="noopener">Element Upload Component</a></li>
</ul>

                </div>
            </div>

            
            <ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者: </strong>
    Zong
  </li>
  <li class="post-copyright-link">
    <strong>本文链接: </strong>
    <a href="https://zongzi531.com/2018/08/03/%E5%88%9D%E6%8E%A2Node-js/" title="初探Node.js">https://zongzi531.com/2018/08/03/%E5%88%9D%E6%8E%A2Node-js/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明: </strong>
    本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0</a> 许可协议。转载请注明出处！
  </li>
</ul>

            
    
            <nav class="post-pagination">
    
    <a class="newer-posts" href="/2018/09/06/%E5%9C%A8JavaScript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B8%8A%E7%9B%98%E6%97%8B/">
        上一篇<br>在 JavaScript 设计模式上盘旋
    </a>
    
    <span class="page-number"></span>
    
    <a class="older-posts" href="/2018/07/04/2018-%E5%A4%8F%E5%A4%A9/">
        下一篇<br>2018 / 夏天
    </a>
    
</nav>

    
            

<div class="post-comment-wrapper">
    <div id="disqus_thread"></div>
</div>


        </div>
    </div>
    <div class="single-column-footer">
    <div style="margin-bottom: 8px;">
        <a title="GitHub" href="https://github.com/zongzi531" target="_blank" rel="noopener" style="margin: 0px 2px;"><svg height="16" width="16" viewBox="0 0 16 16" version="1.1" aria-hidden="true"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path></svg></a>
        <a title="知乎" href="https://www.zhihu.com/people/zongzi531/posts" target="_blank" rel="noopener" style="margin: 0px 2px;"><img height="16" src="https://static.zhihu.com/static/favicon.ico"></a>
        <a title="掘金" href="https://juejin.im/user/58747cf2ac502e00646e3b8b/posts" target="_blank" rel="noopener" style="margin: 0px 2px;"><img height="16" src="https://b-gold-cdn.xitu.io/favicons/v2/favicon.ico"></a>
        <a title="力扣" href="https://leetcode-cn.com/u/zongzi0531/" target="_blank" rel="noopener" style="margin: 0px 2px;"><img height="16" src="https://static.leetcode-cn.com/cn-assets/icons/favicon-32x32.png"></a>
    </div>
    &copy; 2017 - 2021 <a href="https://zongzi531.com">Zong</a>
</div>
</div>

</div>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"
        integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.4/dist/umd/popper.min.js"
        integrity="sha256-EGs9T1xMHdvM1geM8jPpoo8EZ1V1VRsmcJz8OByENLA=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/js/bootstrap.min.js"
        integrity="sha256-VsEqElsCHSGmnmHXGQzvoWjWwoznFSZc6hs7ARLRacQ=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/vue@2.5.17/dist/vue.min.js"
        integrity="sha256-FtWfRI+thWlNz2sB3SJbwKx5PgMyKIVgwHCTwa3biXc=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/smooth-scroll@14.2.1/dist/smooth-scroll.polyfills.min.js"
        integrity="sha256-CI4Gq5E0io1Pv0xM3qPM+NUIOhbIBvC3GiN1Y4KhXpw=" crossorigin="anonymous"></script>
<script src="/js/journal.js?3103906"></script>


<script>
    var disqus_shortname = 'zongzi';
    var disqus_config = function () {
        this.page.url = 'https://zongzi531.com/2018/08/03/初探Node-js/';
        this.page.identifier = '/2018/08/03/初探Node-js/';
    };
    (function () {
        var d = document, s = d.createElement('script');
        s.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.body || d.head).appendChild(s);
    })();
</script>


</body>
</html>
